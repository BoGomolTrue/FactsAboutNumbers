<template>
  <div class="home">
     <div class="app__jimbo">
      <b-spinner class="app__jimbo__spinner" v-if="loading == true"></b-spinner>
      <div class="content" v-if="loading == false">
      <b-jumbotron header="Facts and Numbers" lead="Select the number and type of fact">
        <div class="wrapper">
          <b-form-input class="app__jimbo__input" v-model.trim="number" :class="{invalid: ($v.number.$dirty && !$v.number.required) || ($v.number.$dirty && !$v.number.number)}" placeholder="Число"></b-form-input>
          <b-form-select class="app__jimbo__select form-control" v-model="selected" :options="options" :class="{invalid: ($v.selected.$dirty && !$v.selected.required) || ($v.selected.$dirty && !$v.selected.selected)}"></b-form-select>
        </div>
        <span v-if="($v.selected.$dirty && !$v.selected.required) || ($v.number.$dirty && !$v.number.required)" class="helper-text invalid">The following errors need to be corrected:</span>
        <span v-if="($v.selected.$dirty && !$v.selected.required)" class="helper-text invalid">Fact type not selected</span>
        <span v-if="($v.number.$dirty && !$v.number.required)" class="helper-text invalid">Number not entered</span>
        <b-button class="app__jimbo__button" variant="primary" href="#" @click="getFact">Get the fact</b-button>
      </b-jumbotron>
      <div class="container-fluid">
        <div class="row">
       <b-jumbotron class="fact__jimbo" v-if="facts != ''">
        <div class="wrapper">
          <span> {{facts}} </span>
         </div>
      </b-jumbotron>
      </div>
      </div>
      </div>
    </div>
  </div>
</template>

<script>
import axios from 'axios'
import { required } from 'vuelidate/lib/validators'
export default {
  name: 'Home',
  components: {
  },
  data () {
    return {
      number: null,
      selected: null,
      facts: '',
      loading: false,
      options: [
        { value: null, text: 'Select the type you want' },
        { value: 'trivia', text: 'Fact from life' },
        { value: 'math', text: 'Math fact' }
      ]
    }
  },
  validations: {
    number: {
      required
    },
    selected: {
      required
    }
  },
  methods: {
    getFact () {
      if (this.$v.$invalid) {
        console.log(this.$v)
        this.$v.$touch()
        return
      }
      this.loading = true
      axios
        .get('http://numbersapi.com/' + this.number + '/' + this.selected + '')
        .then((response) => {
          this.facts = response.data.replace(/[0-9]/g, '').replace(/-/g, ' ')
          this.loading = false
          if (this.facts.indexOf('numbersapi') > -1) {
            this.facts = 'is an uninteresting number.'
          }
        }
        )
    }
  }
}
</script>
<style lang="scss" scoped>
  .app__jimbo {
    color: white;
    position: absolute;
    top: 25%;
    width: 100%;
    &__spinner{
      position: absolute;
      width: 10rem;
      height: 10rem;
      top: 20%;
      right: 45%;
    }
    &__input {
      display: inline;
      margin: 0 auto;
      text-align: center;
      width:100px;
      margin-bottom: 40px;
    }
    &__button {
      background: black;
      border-color: gray;
      &:hover{
        background: black;
        border-color: gray;
      }
      &:active {
        background: black;
        border-color: gray;
      }
      &:focus {
        background: black;
        border-color: gray;
      }
    }
    &__select{
      width: 200px;
      display: inline;
      height: 38px;
      border: 1px solid #ced4da;
      border-radius: 0.25rem;
    }
  }
  .helper-text {
    display: block;
    padding-bottom: 20px;
    color: red;
  }
  .fact__jimbo{
    text-align: cemter;
    width: 300px;
    height: auto;
    margin: 50px auto;
    border: 1px solid gray;
    & span{
      font-size: 20px;
    }
  }
</style>
